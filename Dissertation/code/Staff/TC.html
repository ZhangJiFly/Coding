<!DOCTYPE HTML>


<html>
  <script src="/js/libs/requirejs/require.js"></script>
  <script src="/requireconfig.js"></script>
  <script> src='../js/libs/media/js/jquery.dataTables.js'</script>
  <script>
    require.config({
    baseUrl: "../js"
    });

    require(['jquery', 'socket.io', 'datatables'], function($, io, dataTable){
      var groupCounter = 0;
      var courses; 
      var createGroup = function(){
        var choices = [];
        groupCounter++;
        $('#main').append("<div class='row'><div class='col-md-4'><table cellpadding='0' cellspacing='0' border='0' class='display dataTable' id='choices" + groupCounter + "'></table></div><div class='col-md-4'><table cellpadding='0' cellspacing='0' border='0' class='display dataTable' id='courses" + groupCounter + "'></table></div></div>");
        $('#choices'+groupCounter).dataTable( {
          "bFilter": false,
          "bInfo": false,
          "bPaginate": false,
          "aaData": choices,
          "aoColumns": [
              { "sTitle": "CourseId" },
              { "sTitle": "Course Name" },
              { "sTitle": "Credits" },
          ]
        } );
        $('#courses'+groupCounter).dataTable( {
          "aaData": courses,
          "aoColumns": [
            {
              "mRender": function (data, type, full ) {
                return "<button type='button' class='btn btn-default' id='select'>Select</button>"
              },
              "fnCreatedCell": function(Td, sData, oData, iRow, iCol){
                // console.log(Td);
                // console.log(sData);
                // console.log(oData);
                var btn = $(Td)['context']['firstChild']; //Terrible coding.. cannot get anything else to work so this will be OK for the demo.
                var button = $(btn);

                button.click(function(){
                  choices.push({iRow:courses[iRow]});
                  console.log(choices);
                });
              },
              "sTitle": "Select",
            },
            { "mData": "Name", "sTitle": "Course Name" },
            { "mData": "Credit", "sTitle": "Credits" },
          ]
        } );
      }
      var socket = io.connect('http://localhost');
      socket.emit('coursesPlease', "Engineering");
      socket.on('courses', function (data) {
        courses = data;
        createGroup();
      });
        
      console.log($('#addGroup'));
      $('#addGroup').click(function(){

        createGroup();
      });

    });
  </script>
  <link rel="stylesheet" type="text/css" href="/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="/css/bootstrap-theme.css">
  <link href="/css/starterTemp.css" rel="stylesheet">
  <head>
   <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
          </button>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="./home">Home</a></li>
            <li><a href="./advisor">Advisor</a></li>
            <li><a href="./lecturer.html">Lecturer</a></li>
            <li class="active"><a href="./TC.html">Teaching Committee</a></li>
            <li><a href="./DHY.html">Dept Head of Year</a></li>
            <li><a href="./help.html">Help</a></li>

          </ul>
          <ul class="nav navbar-nav pull-right">
            <li><a href="/logout">Logout</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
  </head>
  <body>
  <div class="container" id="main" >
    <button type="button" class="btn btn-default" id="addGroup">Add Group</button>
   
  </div>
  </body>

</html>